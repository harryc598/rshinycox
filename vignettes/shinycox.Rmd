---
title: "shinycox"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{shinycox}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(rshinycox)
```
## Introduction
This vignette will provide an example case of how this package could be used. It is assumed that a Cox model has already been found, for this example the statistical validity of the Cox model is not the primary consideration, and the application makes no checks on the model itself. It is for visualization purposes. 

## One Curve
```{r}
library(survival)
colonph <- coxph(Surv(time, status) ~ age + extent, data = colon,
                  x = TRUE, model = TRUE)
```
This model satisfies all the requirements for use with the 'shinycox' package, so simply use
```{r eval = FALSE}
colonshiny <- shine_coxph("Model" = colonph, app.dir = tempdir())

filedir <- list.files(tempdir())[1]
shiny::runApp(paste0(tempdir(), "/", filedir))
```
and the shiny application will be created in a sub-folder of the temporary directory, which can be run. There are two theme options as well, with the `"dashboard"` theme requiring the installation of the 'DT' and 'shinydashboard' packages. Both applications contain the same information.

## Multiple Curves
The package allows for multiple curves as well, which will be demonstrated using the different treatment arms of the `"colon"` data from 'survival'.
```{r}
split_colon <- split(colon, colon$rx)

colon_Obs <- split_colon$Obs
colon_Lev <- split_colon$Lev
colon_Lev5FU <- split_colon$`Lev+5FU`

# Fitting the Cox model for each treatment group
colonObs.ph <- coxph(Surv(time, status) ~ extent + factor(node4),
                     colon_Obs, x = TRUE, model = TRUE)
colonLev.ph <- coxph(Surv(time, status) ~ extent + factor(node4),
                     colon_Lev, x = TRUE, model = TRUE)
colonLevFU.ph <- coxph(Surv(time, status) ~ extent + factor(node4),
                       colon_Lev5FU, x = TRUE, model = TRUE)
```
To use `shine_coxph()` with multiple curves, just put all three models into the function. Giving them names will be helpful too, as they show up in the legend and tabs of the application.
```{r eval = FALSE}
multicurve <- shine_coxph("Obs" = colonObs.ph, "Lev" = colonLev.ph, 
                          "Lev+5FU" = colonLevFU.ph, app.dir = tempdir())

filedir <- list.files(tempdir())[1]
shiny::runApp(paste0(tempdir(), "/", filedir))
```

